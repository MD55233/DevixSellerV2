{"version":3,"file":"static/js/103.7621df23.chunk.js","mappings":"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","sources":["views/utilities/AllTransaction.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  Paper,\r\n  Typography,\r\n  CircularProgress,\r\n  Box,\r\n  Grid,\r\n} from '@mui/material';\r\nimport axios from 'axios';\r\nimport { useAuth } from 'views/pages/authentication/AuthContext';\r\n\r\nconst TransactionHistory = () => {\r\n  const { username } = useAuth(); // Get username from auth context\r\n  const [transactions, setTransactions] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    const fetchTransactions = async () => {\r\n      try {\r\n        const [\r\n          withdrawalsResponse,\r\n          bonusesResponse,\r\n          approvedResponse,\r\n          rejectedResponse,\r\n          referralResponse,\r\n          approvedReferralResponse,\r\n          rejectedReferralResponse,\r\n          taskTransactionsResponse, // Fetching task transactions\r\n        ] = await Promise.all([\r\n          axios.get(`${process.env.REACT_APP_API_HOST}/api/withdrawals/${username}`),\r\n          axios.get(`${process.env.REACT_APP_API_HOST}/api/training-bonus/${username}`),\r\n          axios.get(`${process.env.REACT_APP_API_HOST}/api/approvals/approve/${username}`), // Approved bonuses\r\n          axios.get(`${process.env.REACT_APP_API_HOST}/api/approvals/reject/${username}`), // Rejected bonuses\r\n          axios.get(`${process.env.REACT_APP_API_HOST}/api/referral-payment/${username}`), // Referral payments\r\n          axios.get(`${process.env.REACT_APP_API_HOST}/api/approvals/referral/approve/${username}`), // Approved referral payments\r\n          axios.get(`${process.env.REACT_APP_API_HOST}/api/approvals/referral/reject/${username}`), // Rejected referral payments\r\n          axios.get(`${process.env.REACT_APP_API_HOST}/api/task-transactions/${username}`), // Fetching task transactions\r\n        ]);\r\n\r\n        // Combine all transaction types into a single array\r\n        const combinedTransactions = [\r\n          ...withdrawalsResponse.data.map(item => ({ ...item, type: 'Withdrawal' })),\r\n          ...bonusesResponse.data.map(item => ({ ...item, type: 'Pending Training Bonus', status: 'pending' })),\r\n          ...approvedResponse.data.map(item => ({ ...item, type: 'Approved Training Bonus', status: 'approved' })),\r\n          ...rejectedResponse.data.map(item => ({ ...item, type: 'Rejected Training Bonus', status: 'rejected' })),\r\n          ...referralResponse.data.map(item => ({\r\n            ...item,\r\n            type: 'Referral Payment Verification',\r\n            status: item.status,\r\n            amount: item.transactionAmount,\r\n            accountNumber: '-', // Update this if you have account number field in your data\r\n            gateway: item.gateway, // Include gateway if available\r\n            remarks: 'Referral payment verification submitted',\r\n          })),\r\n          ...approvedReferralResponse.data.map(item => ({\r\n            ...item,\r\n            type: 'Approved Referral Payment',\r\n            status: 'approved',\r\n          })),\r\n          ...rejectedReferralResponse.data.map(item => ({\r\n            ...item,\r\n            type: 'Rejected Referral Payment',\r\n            status: 'rejected',\r\n            remarks: item.feedback || 'No feedback provided', // Include feedback in remarks for rejected payments\r\n          })),\r\n          ...taskTransactionsResponse.data.map(item => ({\r\n            ...item,\r\n            type: 'Task Transaction',\r\n            status: item.status,\r\n            amount: item.amount,\r\n            taskName: item.taskId.name,  // Add task name from populated taskId\r\n            accountNumber: '-',  // Placeholder\r\n            gateway: '-',  // Placeholder\r\n            remarks: item.description,\r\n          })),\r\n        ];\r\n\r\n        // Sort transactions by date in descending order\r\n        combinedTransactions.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));\r\n\r\n        setTransactions(combinedTransactions);\r\n        setLoading(false);\r\n      } catch (error) {\r\n        console.error('Error fetching transaction history:', error);\r\n        setError('Error fetching transaction history. Please try again.');\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchTransactions();\r\n  }, [username]);\r\n\r\n  const getStatusStyles = (status) => {\r\n    switch (status) {\r\n      case 'approved':\r\n        return { backgroundColor: '#d4edda', color: '#155724' }; // Light green background\r\n      case 'rejected':\r\n        return { backgroundColor: '#f8d7da', color: '#721c24' }; // Light red background\r\n      case 'pending':\r\n        return { backgroundColor: '#fff3cd', color: '#856404' }; // Light yellow background\r\n      default:\r\n        return { backgroundColor: '#ffffff', color: '#000000' }; // Default white background\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Grid container spacing={3} justifyContent=\"center\">\r\n      <Grid item xs={12}>\r\n        <Typography variant=\"h3\" gutterBottom sx={{ color: 'secondary.main', textAlign: 'center' }}>\r\n          Transaction History\r\n        </Typography>\r\n      </Grid>\r\n\r\n      <Grid item xs={12} sm={8}>\r\n        {loading ? (\r\n          <CircularProgress />\r\n        ) : error ? (\r\n          <Typography color=\"error\" variant=\"h6\">{error}</Typography>\r\n        ) : transactions.length === 0 ? (\r\n          <Typography variant=\"h6\">No transactions found.</Typography>\r\n        ) : (\r\n          <TableContainer component={Paper}>\r\n            <Table>\r\n              <TableHead>\r\n                <TableRow>\r\n                  <TableCell>Date</TableCell>\r\n                  <TableCell>Type</TableCell>\r\n                  <TableCell>Amount</TableCell>\r\n                  <TableCell>Status</TableCell>\r\n                  <TableCell>Account Number</TableCell>\r\n                  <TableCell>Gateway</TableCell>\r\n                  <TableCell>Remarks</TableCell>\r\n                </TableRow>\r\n              </TableHead>\r\n              <TableBody>\r\n                {transactions.map((transaction) => (\r\n                  <TableRow key={transaction._id}>\r\n                    <TableCell>{new Date(transaction.createdAt).toLocaleDateString()}</TableCell>\r\n                    <TableCell>{transaction.type}</TableCell>\r\n                    <TableCell>Rs {transaction.amount}</TableCell>\r\n                    <TableCell>\r\n                      <Box sx={{\r\n                        ...getStatusStyles(transaction.status),\r\n                        padding: '4px 8px',\r\n                        borderRadius: '4px',\r\n                        display: 'inline-block'\r\n                      }}>\r\n                        {transaction.status}\r\n                      </Box>\r\n                    </TableCell>\r\n                    <TableCell>{transaction.accountNumber || '-'}</TableCell>\r\n                    <TableCell>{transaction.gateway || '-'}</TableCell>\r\n                    <TableCell>{transaction.remarks || '-'}</TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          </TableContainer>\r\n        )}\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n\r\nexport default TransactionHistory;\r\n"],"names":["TransactionHistory","username","useAuth","transactions","setTransactions","useState","loading","setLoading","error","setError","useEffect","async","withdrawalsResponse","bonusesResponse","approvedResponse","rejectedResponse","referralResponse","approvedReferralResponse","rejectedReferralResponse","taskTransactionsResponse","Promise","all","axios","combinedTransactions","data","map","item","type","status","amount","transactionAmount","accountNumber","gateway","remarks","feedback","taskName","taskId","name","description","sort","a","b","Date","createdAt","console","fetchTransactions","getStatusStyles","backgroundColor","color","_jsxs","Grid","container","spacing","justifyContent","children","_jsx","xs","Typography","variant","gutterBottom","sx","textAlign","sm","CircularProgress","length","TableContainer","component","Paper","Table","TableHead","TableRow","TableCell","TableBody","transaction","toLocaleDateString","Box","padding","borderRadius","display","_id"],"sourceRoot":""}